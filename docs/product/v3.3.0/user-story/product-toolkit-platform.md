# 用户故事：Product Toolkit Platform（v3.3.0）

**状态**: In Review  
**来源**: think_vnext 契约梳理  
**范围**: Product Toolkit 全链路（think → delivery）

---

## 用户故事总览

| US | 标题 | 优先级 | 状态 |
|---|---|---|---|
| US-001 | think vNext 需求澄清 | P0 | Ready |
| US-002 | 用户故事生成 | P0 | Ready |
| US-003 | PRD 生成 | P0 | Ready |
| US-004 | 测试用例生成与 AC→TC 映射 | P0 | Ready |
| US-005 | workflow 串联与门控 | P0 | Ready |
| US-006 | 状态持久化与 save/resume | P1 | Ready |
| US-007 | 记忆系统（remember/recall/test-learnings） | P1 | Ready |
| US-008 | 自动化测试 strict 生命周期 | P0 | Ready |
| US-009 | test-progress 汇总与缺口回填 | P0 | Ready |
| US-010 | 版本演进与发布检查 | P1 | Ready |

---

### US-001: think vNext 需求澄清

**用户故事**: 作为产品经理，我希望通过结构化追问快速收敛需求，以便下游文档直接消费。  

**验收标准（7维）**

- [ ] US001-AC01 正向流程：支持批量提问并输出结构化结论
- [ ] US001-AC02 边界校验：可识别信息不足并动态追问
- [ ] US001-AC03 错误处理：输入不完整时给出缺失字段提示
- [ ] US001-AC04 成功反馈：每轮输出自动摘要
- [ ] US001-AC05 性能要求：中等规模需求在可接受时延内完成收敛
- [ ] US001-AC06 权限控制：不暴露敏感凭据信息
- [ ] US001-AC07 撤销回退：保留轮次摘要，支持人工修订

### US-002: 用户故事生成

**用户故事**: 作为产品经理，我希望从 think 结果自动生成用户故事，以便保持口径一致。  

**验收标准（7维）**

- [ ] US002-AC01 正向流程：生成标准“作为/我希望/以便”故事主句
- [ ] US002-AC02 边界校验：缺 actor/value 时标记 Blocked
- [ ] US002-AC03 错误处理：冲突未解时输出 Warn/Blocked
- [ ] US002-AC04 成功反馈：输出 7 维 AC 列表
- [ ] US002-AC05 性能要求：批量故事生成稳定
- [ ] US002-AC06 权限控制：权限相关 AC 可显式落文
- [ ] US002-AC07 撤销回退：可按故事粒度增删改

### US-003: PRD 生成

**用户故事**: 作为产品负责人，我希望输出可评审 PRD，以便研发与 QA 对齐交付标准。  

**验收标准（7维）**

- [ ] US003-AC01 正向流程：产出完整 PRD 章节（目标/范围/流程/NFR/风险）
- [ ] US003-AC02 边界校验：in_scope/out_of_scope 均需明确
- [ ] US003-AC03 错误处理：阻塞冲突未解决则状态为 Blocked
- [ ] US003-AC04 成功反馈：给出明确交付判定与下一步动作
- [ ] US003-AC05 性能要求：中型功能 PRD 输出稳定
- [ ] US003-AC06 权限控制：权限策略落入非功能章节
- [ ] US003-AC07 撤销回退：支持版本化迭代与差异记录

### US-004: 测试用例生成与 AC→TC 映射

**用户故事**: 作为 QA，我希望自动生成可执行测试用例并完整映射 AC，以便避免遗漏。  

**验收标准（7维）**

- [ ] US004-AC01 正向流程：生成 smoke/regression/full 用例集
- [ ] US004-AC02 边界校验：一个 AC 可映射多个 TC
- [ ] US004-AC03 错误处理：AC 覆盖不足时 Gate2=Blocked
- [ ] US004-AC04 成功反馈：输出 AC→TC 覆盖矩阵
- [ ] US004-AC05 性能要求：大用例集生成可用
- [ ] US004-AC06 权限控制：权限/越权场景必须有 TC
- [ ] US004-AC07 撤销回退：支持回归集更新与补漏

### US-005: workflow 串联与门控

**用户故事**: 作为团队负责人，我希望一键编排全流程并可门控，以便确保阶段质量。  

**验收标准（7维）**

- [ ] US005-AC01 正向流程：workflow 可串联核心阶段
- [ ] US005-AC02 边界校验：阶段输入缺失时阻断流转
- [ ] US005-AC03 错误处理：门控失败时给出具体原因
- [ ] US005-AC04 成功反馈：展示阶段状态与进度
- [ ] US005-AC05 性能要求：阶段切换稳定
- [ ] US005-AC06 权限控制：强制覆盖需显式记录
- [ ] US005-AC07 撤销回退：支持强制继续并留痕

### US-006: 状态持久化与 save/resume

**用户故事**: 作为长期迭代用户，我希望跨会话恢复上下文，以便减少重复沟通。  

**验收标准（7维）**

- [ ] US006-AC01 正向流程：save 可写入当前状态
- [ ] US006-AC02 边界校验：无会话数据时给出空态提示
- [ ] US006-AC03 错误处理：状态文件损坏时可降级恢复
- [ ] US006-AC04 成功反馈：resume 返回关键上下文
- [ ] US006-AC05 性能要求：状态读写耗时可控
- [ ] US006-AC06 权限控制：敏感数据不应明文落盘
- [ ] US006-AC07 撤销回退：支持回退到上一个稳定快照

### US-007: 记忆系统（remember/recall/test-learnings）

**用户故事**: 作为复盘驱动团队，我希望沉淀决策与踩坑记忆，以便越跑越顺。  

**验收标准（7维）**

- [ ] US007-AC01 正向流程：remember 可写入洞察/决策/术语
- [ ] US007-AC02 边界校验：重复条目可归并
- [ ] US007-AC03 错误处理：检索不到时返回清晰提示
- [ ] US007-AC04 成功反馈：recall 返回可执行建议
- [ ] US007-AC05 性能要求：检索性能可接受
- [ ] US007-AC06 权限控制：敏感记忆支持脱敏
- [ ] US007-AC07 撤销回退：支持修订记忆条目

### US-008: 自动化测试 strict 生命周期

**用户故事**: 作为 QA 自动化工程师，我希望严格执行并产出生命周期会话，以便可审计。  

**验收标准（7维）**

- [ ] US008-AC01 正向流程：start→record→stop→consolidate 全链路可运行
- [ ] US008-AC02 边界校验：0 case、声明不一致、US 不完整时阻塞
- [ ] US008-AC03 错误处理：UI/API/Manual 失败有明确原因码
- [ ] US008-AC04 成功反馈：输出 session 报告与阻塞分布
- [ ] US008-AC05 性能要求：多轮测试稳定可重复
- [ ] US008-AC06 权限控制：凭据输入需外置并脱敏
- [ ] US008-AC07 撤销回退：失败签名支持 playbook 复用

### US-009: test-progress 汇总与缺口回填

**用户故事**: 作为项目负责人，我希望查看版本级测试进度与缺口，以便决策是否发布。  

**验收标准（7维）**

- [ ] US009-AC01 正向流程：自动产出 test-progress 汇总
- [ ] US009-AC02 边界校验：支持 missing US/missing TC 检测
- [ ] US009-AC03 错误处理：报告生成失败可重试
- [ ] US009-AC04 成功反馈：输出 by_us/by_mode 维度矩阵
- [ ] US009-AC05 性能要求：多会话聚合稳定
- [ ] US009-AC06 权限控制：报告脱敏可共享
- [ ] US009-AC07 撤销回退：允许补录后重跑形成闭环

### US-010: 版本演进与发布检查

**用户故事**: 作为发布负责人，我希望按版本追踪需求与测试演进，以便降低上线风险。  

**验收标准（7维）**

- [ ] US010-AC01 正向流程：版本规划到发布清单链路完整
- [ ] US010-AC02 边界校验：未达测试门禁不可标记 Ready
- [ ] US010-AC03 错误处理：关键风险未闭环时阻断发布
- [ ] US010-AC04 成功反馈：演进总结可追踪变更
- [ ] US010-AC05 性能要求：多版本文档生成稳定
- [ ] US010-AC06 权限控制：发布审批痕迹可审计
- [ ] US010-AC07 撤销回退：支持回滚预案落文

---

## 冲突与未决问题

### 冲突（Warn）

1. Manual 回填易被机械通过（需抽样复核机制）
2. API expectation 自动推断存在少量误判风险

### 未决（Open Questions）

1. 是否引入 manual 回填审批状态机
2. 是否引入 API case-level 断言配置文件
